<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <meta name="generator" content="VuePress 2.0.0-beta.48">
    <style>
      :root {
        --c-bg: #fff;
      }
      html.dark {
        --c-bg: #22272e;
      }
      html, body {
        background-color: var(--c-bg);
      }
    </style>
    <script>
      const userMode = localStorage.getItem('vuepress-color-scheme');
			const systemDarkMode = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
			if (userMode === 'dark' || (userMode !== 'light' && systemDarkMode)) {
				document.documentElement.classList.toggle('dark', true);
			}
    </script>
    <title>Cookie | Azi Studio</title><meta name="description" content="">
    <link rel="modulepreload" href="assets/app.47e28445.js"><link rel="modulepreload" href="assets/index.html.18881a38.js"><link rel="modulepreload" href="assets/index.html.f9e5251a.js"><link rel="prefetch" href="assets/index.html.b9a71933.js"><link rel="prefetch" href="assets/404.html.265028f6.js"><link rel="prefetch" href="assets/index.html.4e58fa9b.js"><link rel="prefetch" href="assets/404.html.17f3a20c.js"><link rel="prefetch" href="assets/404.b31e9cf5.js"><link rel="prefetch" href="assets/Layout.beaf74ac.js">
    <link rel="stylesheet" href="assets/style.a781a21f.css">
  </head>
  <body>
    <div id="app"><!--[--><div class="theme-container"><!--[--><header class="navbar"><div class="toggle-sidebar-button" title="toggle sidebar" aria-expanded="false" role="button" tabindex="0"><div class="icon" aria-hidden="true"><span></span><span></span><span></span></div></div><span><a href="/" class=""><!----><span class="site-name">Azi Studio</span></a></span><div class="navbar-items-wrapper" style=""><!--[--><!--]--><!----><!--[--><!--]--><button class="toggle-color-mode-button" title="toggle color mode"><svg style="" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M16 12.005a4 4 0 1 1-4 4a4.005 4.005 0 0 1 4-4m0-2a6 6 0 1 0 6 6a6 6 0 0 0-6-6z" fill="currentColor"></path><path d="M5.394 6.813l1.414-1.415l3.506 3.506L8.9 10.318z" fill="currentColor"></path><path d="M2 15.005h5v2H2z" fill="currentColor"></path><path d="M5.394 25.197L8.9 21.691l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 25.005h2v5h-2z" fill="currentColor"></path><path d="M21.687 23.106l1.414-1.415l3.506 3.506l-1.414 1.414z" fill="currentColor"></path><path d="M25 15.005h5v2h-5z" fill="currentColor"></path><path d="M21.687 8.904l3.506-3.506l1.414 1.415l-3.506 3.505z" fill="currentColor"></path><path d="M15 2.005h2v5h-2z" fill="currentColor"></path></svg><svg style="display:none;" class="icon" focusable="false" viewBox="0 0 32 32"><path d="M13.502 5.414a15.075 15.075 0 0 0 11.594 18.194a11.113 11.113 0 0 1-7.975 3.39c-.138 0-.278.005-.418 0a11.094 11.094 0 0 1-3.2-21.584M14.98 3a1.002 1.002 0 0 0-.175.016a13.096 13.096 0 0 0 1.825 25.981c.164.006.328 0 .49 0a13.072 13.072 0 0 0 10.703-5.555a1.01 1.01 0 0 0-.783-1.565A13.08 13.08 0 0 1 15.89 4.38A1.015 1.015 0 0 0 14.98 3z" fill="currentColor"></path></svg></button><!----></div></header><!--]--><div class="sidebar-mask"></div><!--[--><aside class="sidebar"><!----><!--[--><!--]--><ul class="sidebar-items"><!--[--><li><p tabindex="0" class="sidebar-item sidebar-heading">Cookie <!----></p><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/tech/cookie/#æœ‰æ•ˆæœŸ-expires-max-age" class="router-link-active router-link-exact-active sidebar-item" aria-label="æœ‰æ•ˆæœŸ  Expires/Max-Age"><!--[--><!--]--> æœ‰æ•ˆæœŸ  Expires/Max-Age <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/tech/cookie/#ä½œç”¨åŸŸ-domain-path" class="router-link-active router-link-exact-active sidebar-item" aria-label="ä½œç”¨åŸŸ Domain/Path"><!--[--><!--]--> ä½œç”¨åŸŸ Domain/Path <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/tech/cookie/#domain" class="router-link-active router-link-exact-active sidebar-item" aria-label="Domain"><!--[--><!--]--> Domain <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/tech/cookie/#path" class="router-link-active router-link-exact-active sidebar-item" aria-label="Path"><!--[--><!--]--> Path <!--[--><!--]--></a><!----></li><!--]--></ul></li><li><a aria-current="page" href="/tech/cookie/#samesite" class="router-link-active router-link-exact-active sidebar-item" aria-label="SameSite"><!--[--><!--]--> SameSite <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/tech/cookie/#é™åˆ¶è®¿é—®-secure-httponly" class="router-link-active router-link-exact-active sidebar-item" aria-label="é™åˆ¶è®¿é—® Secure/HttpOnly"><!--[--><!--]--> é™åˆ¶è®¿é—® Secure/HttpOnly <!--[--><!--]--></a><ul style="" class="sidebar-item-children"><!--[--><li><a aria-current="page" href="/tech/cookie/#secure" class="router-link-active router-link-exact-active sidebar-item" aria-label="Secure"><!--[--><!--]--> Secure <!--[--><!--]--></a><!----></li><li><a aria-current="page" href="/tech/cookie/#httponly" class="router-link-active router-link-exact-active sidebar-item" aria-label="HttpOnly"><!--[--><!--]--> HttpOnly <!--[--><!--]--></a><!----></li><!--]--></ul></li><!--]--></ul></li><!--]--></ul><!--[--><!--]--></aside><!--]--><!--[--><main class="page"><!--[--><!--]--><div class="theme-default-content"><!--[--><!--]--><div><h1 id="cookie" tabindex="-1"><a class="header-anchor" href="#cookie" aria-hidden="true">#</a> Cookie</h1><p>Category: Broswer Priority: â­ï¸â­ï¸â­ï¸â­ï¸â­ï¸ Property: April 17, 2022 6:49 PM Status: å·²å®Œæˆ</p><h1 id="å†å²" tabindex="-1"><a class="header-anchor" href="#å†å²" aria-hidden="true">#</a> å†å²</h1><p>ç”±ç½‘æ™¯å…¬å¸1993å‘æ˜ï¼Œæ˜¯ç½‘ç«™ä¸ºäº†è¾¨åˆ«ç”¨æˆ·èº«ä»½è€Œå­˜å‚¨åœ¨ç»ˆç«¯çš„ä¸€æ®µæ•°æ®ã€‚</p><p>ç”±äº HTTP åè®®æ˜¯æ— çŠ¶æ€çš„ï¼Œå¯¼è‡´Webåº”ç”¨çš„äº¤äº’èƒ½åŠ›å¾ˆå·®ï¼ŒCookie å°±æ˜¯ç”¨æ¥è§£å†³ HTTP æ— çŠ¶æ€æ€§çš„é‡è¦æ‰‹æ®µã€‚</p><p>åŒæ—¶ç”±äº Cookie é€šå¸¸ç”¨æ¥ä½œä¸ºç”¨æˆ·æ ‡è®°ï¼Œæ‰€ä»¥ä¹Ÿæˆä¸ºå‰ç«¯å®‰å…¨é¢†åŸŸçš„é‡è¦ä¸€å—ã€‚</p><p><em>åœ¨æœ‰äº† Cookie ä»¥åï¼Œåç»­åˆå‡ºç°äº† åŒæºç­–ç•¥ï¼ˆSOPï¼‰ æ¥åŠ å¼º Cookie çš„å®‰å…¨ï¼Œä¹‹ååˆå‡ºç°äº† CORS å’Œ CSP è¿™äº›å…³äºèµ„æºè®¿é—®æƒé™çš„é…ç½®è§„èŒƒã€‚åŒæ—¶ï¼Œå¤§é‡çš„ä»¥ç›—ç”¨ Cookie ä¸ºç›®æ ‡çš„ XSSã€CSRF æ”»å‡»ä¹Ÿå‡ºç°äº†ã€‚</em></p><hr><h1 id="é€šå¸¸ä½œç”¨" tabindex="-1"><a class="header-anchor" href="#é€šå¸¸ä½œç”¨" aria-hidden="true">#</a> é€šå¸¸ä½œç”¨</h1><p>å®ƒçš„æ ¸å¿ƒæ˜¯å‘Šè¯‰æœåŠ¡ç«¯ï¼Œè¿™ä¸ªè¯·æ±‚æ˜¯æ¥è‡ªäºå“ªä¸ªæµè§ˆå™¨ã€‚</p><p>åŒ…æ‹¬å®ƒçš„å®é™…è½åœ°åœºæ™¯ï¼š</p><ul><li>ä¼šè¯çŠ¶æ€ç®¡ç†ï¼ˆå¦‚ç”¨æˆ·ç™»å½•çŠ¶æ€ã€è´­ç‰©è½¦ã€æ¸¸æˆåˆ†æ•°æˆ–å…¶å®ƒéœ€è¦è®°å½•çš„ä¿¡æ¯ï¼‰</li><li>ä¸ªæ€§åŒ–è®¾ç½®ï¼ˆå¦‚ç”¨æˆ·è‡ªå®šä¹‰è®¾ç½®ã€ä¸»é¢˜ç­‰ï¼‰</li><li>æµè§ˆå™¨è¡Œä¸ºè·Ÿè¸ªï¼ˆå¦‚è·Ÿè¸ªåˆ†æç”¨æˆ·è¡Œä¸ºç­‰ï¼‰</li></ul><p>å®ƒçš„æœ¬è´¨éƒ½æ˜¯é€šè¿‡ Cookie å‘Šè¯‰äº†æœåŠ¡å™¨ã€Œæˆ‘æ˜¯è°ã€</p><hr><h1 id="åˆ›å»º-cookie" tabindex="-1"><a class="header-anchor" href="#åˆ›å»º-cookie" aria-hidden="true">#</a> åˆ›å»º Cookie</h1><p>é€šè¿‡æœåŠ¡å™¨åœ¨ HTTP Response Header ä¸­è®¾ç½®å¯¹åº”çš„å­—æ®µæ¥å®ç°ï¼Œæ¯”å¦‚åœ¨Bç«™çš„é¡µé¢ä¸­ï¼š</p><p><img src="assets/Untitled.17410f47.png" alt="Untitled"></p><p>åœ¨æœªç™»å½•çš„çŠ¶æ€ä¸‹ï¼ŒæœåŠ¡ç«¯è®¾ç½®å‘æµè§ˆå™¨è®¾ç½®äº†ä¸€ä¸ªã€Œsidã€çš„cookie</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>set-cookie: sid=c13krggs; Path=/; Domain=bilibili.com
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><aside> ğŸ‘¨ğŸ»â€ğŸ’» å®ƒæ²¡æœ‰è®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œä¸”è¿™ä¸ªè¯·æ±‚æ²¡æœ‰æœ‰æ•ˆçš„ response bodyã€‚å¯ä»¥çŒœæµ‹è¿™ä¸ª sid æ˜¯ç”¨æ¥è¿½è¸ªæœªç™»å½•ç”¨æˆ·çš„è¡Œä¸ºã€‚ </aside><p>ä¹‹åå†çœ‹åç»­çš„è¯·æ±‚ï¼Œå°±ä¼šå‘ç°è¿™ä¸ª Cookie å·²ç»è¢«å¸¦ä¸Š</p><h1 id="å±æ€§" tabindex="-1"><a class="header-anchor" href="#å±æ€§" aria-hidden="true">#</a> å±æ€§</h1><p>æ ‡å‡†æ–‡æ¡£</p><p><a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Set-Cookie" target="_blank" rel="noopener noreferrer">Set-Cookie - HTTP | MDN<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>Set-Cookie: &lt;cookie-name&gt;=&lt;cookie-value&gt;; Expires=&lt;date&gt;
Set-Cookie: &lt;cookie-name&gt;=&lt;cookie-value&gt;; Max-Age=&lt;non-zero-digit&gt;
Set-Cookie: &lt;cookie-name&gt;=&lt;cookie-value&gt;; Domain=&lt;domain-value&gt;
Set-Cookie: &lt;cookie-name&gt;=&lt;cookie-value&gt;; Path=&lt;path-value&gt;
Set-Cookie: &lt;cookie-name&gt;=&lt;cookie-value&gt;; Secure
Set-Cookie: &lt;cookie-name&gt;=&lt;cookie-value&gt;; HttpOnly
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><p>æœ€ç®€å•çš„è®¾ç½®æ–¹æ³•æ˜¯</p><div class="language-jsx ext-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token comment">// è¿™æ ·è®¾ç½®çš„æ˜¯ä¸€ä¸ªä¸´æ—¶ cookieï¼Œå­˜å‚¨åœ¨å†…å­˜ä¸­ï¼Œæµè§ˆå™¨å…³é—­ä»¥å cookie å°±ä¼šå¤±æ•ˆ</span>
set<span class="token operator">-</span>cookie<span class="token operator">:</span> sid<span class="token operator">=</span><span class="token number">1234</span><span class="token punctuation">;</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div></div></div><h2 id="æœ‰æ•ˆæœŸ-expires-max-age" tabindex="-1"><a class="header-anchor" href="#æœ‰æ•ˆæœŸ-expires-max-age" aria-hidden="true">#</a> æœ‰æ•ˆæœŸ Expires/Max-Age</h2><p>è®¾ç½® Cookie çš„ Expires å±æ€§ï¼Œä¼šä½¿å¾—ï¼š</p><ol><li>cookie å˜æˆæŒä¹… cookieï¼Œå®ƒä¸ä¼šéšç€æµè§ˆå™¨å…³é—­è€Œå¤±æ•ˆ</li><li>cookie åˆ°æŒ‡å®šçš„è¿‡æœŸæ—¶é—´åä¼šå¤±æ•ˆ</li></ol><p><s>è€Œè®¾ç½® max-age ä¸ä¼šä½¿ cookie æŒä¹…åŒ–ï¼Œä½†æ˜¯æœ‰æ—¶æ•ˆé™åˆ¶çš„åŠŸèƒ½ã€‚</s></p><p>å®æµ‹å‘ç°ï¼Œå¦‚æœåªè®¾ç½® cookie çš„ max-ageï¼Œå…¶å®ä¹Ÿä¼šè¢«æµè§ˆå™¨è½¬åŒ–ä¸º expires å±æ€§å­˜å‚¨ã€‚</p><div class="language-jsx ext-jsx line-numbers-mode"><pre class="language-jsx"><code><span class="token comment">// è¿™æ ·è®¾ç½®çš„æ˜¯ä¸€ä¸ªæŒä¹… cookieï¼Œèƒ½å¤Ÿä¸€ç›´ç”Ÿæ•ˆåˆ°æŒ‡å®šæ—¶é—´</span>
set<span class="token operator">-</span>cookie<span class="token operator">:</span> sid<span class="token operator">=</span><span class="token number">1234</span><span class="token punctuation">;</span>expires<span class="token operator">=</span>Wed<span class="token punctuation">,</span> <span class="token number">21</span> Oct <span class="token number">2020</span> <span class="token number">07</span><span class="token operator">:</span><span class="token number">28</span><span class="token operator">:</span><span class="token number">00</span> <span class="token constant">GMT</span><span class="token punctuation">;</span> <span class="token comment">// HTTP Date è§„èŒƒ</span>
set<span class="token operator">-</span>cookie<span class="token operator">:</span> sid<span class="token operator">=</span><span class="token number">1234</span><span class="token punctuation">;</span>max<span class="token operator">-</span>age<span class="token operator">=</span><span class="token number">60</span><span class="token punctuation">;</span>  <span class="token comment">// å•ä½ä¸ºç§’</span>
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div><div class="line-number"></div><div class="line-number"></div></div></div><ul><li>expire çš„å†…å®¹åº”è¯¥ç¬¦åˆ <a href="https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Date" target="_blank" rel="noopener noreferrer">HTTP Date è§„èŒƒ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a>ï¼Œjs é‡Œé¢å¯ä»¥é€šè¿‡ <code>Date.prototype.toUTCString()</code> è·å¾—</li><li>å½“ max-age å’Œ expire åŒæ—¶å­˜åœ¨æ—¶ï¼Œä»¥ max-age ä¸ºå‡†ã€‚</li></ul><aside> ğŸ‘¨ğŸ»â€ğŸ’» ç›¸å…³å®éªŒï¼š <p><a href="https://www.notion.so/Cookie-expires-max-age-92917929d5f2461696ab3211e06c070a" target="_blank" rel="noopener noreferrer">Cookie expires å’Œ max-age å®éªŒ<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></aside><h2 id="ä½œç”¨åŸŸ-domain-path" tabindex="-1"><a class="header-anchor" href="#ä½œç”¨åŸŸ-domain-path" aria-hidden="true">#</a> ä½œç”¨åŸŸ Domain/Path</h2><p><code>Domain</code>Â å’ŒÂ <code>Path</code>Â æ ‡è¯†å®šä¹‰äº†Cookieçš„*ä½œç”¨åŸŸï¼š*å³å…è®¸Â Cookie å‘é€ç»™å“ªäº›URLã€‚</p><h3 id="domain" tabindex="-1"><a class="header-anchor" href="#domain" aria-hidden="true">#</a> Domain</h3><p><code>Domain</code> æŒ‡å®šäº†å“ªäº›åŸŸåä¼šå¸¦ä¸Š Cookieã€‚</p><p>å¦‚æœä¸æŒ‡å®šï¼Œæµè§ˆå™¨ä¼šé»˜è®¤å°†å…¶è®¾ä¸ºå½“å‰ URL çš„ä¸€çº§åŸŸåï¼Œæ¯”å¦‚<code>[www.example.com](http://www.example.com/)</code>ä¼šè®¾ä¸º<code>[example.com](http://example.com/)</code>ï¼Œè€Œä¸”ä»¥åå¦‚æœè®¿é—®<code>[example.com](http://example.com/)</code>çš„ä»»ä½•å­åŸŸåï¼ŒHTTP è¯·æ±‚ä¹Ÿä¼šå¸¦ä¸Šè¿™ä¸ª Cookieã€‚</p><p>å¦‚æœæŒ‡å®šäº†<code>Domain</code>ï¼Œåˆ™ä¸€èˆ¬åŒ…å«å­åŸŸåã€‚</p><p>é€šå¸¸æˆ‘ä»¬é€šè¿‡è®¾ç½® Domain æ¥è®©ä¸€æ®µ Cookie åœ¨åŒç«™ç‚¹å…±äº«ï¼ˆç™»å½•æ€ï¼‰</p><blockquote><p>å¤§å¤šæ•°æµè§ˆå™¨éƒ½éµå¾ª RFC è§„èŒƒï¼Œè®¾ç½® Domain æ—¶ä¸éœ€è¦åŠ å‰å¯¼çš„ç‚¹ã€‚ Domain=.azi.com å’Œ Domain=azi.com ä½œç”¨ä¸€è‡´ã€‚</p></blockquote><h3 id="path" tabindex="-1"><a class="header-anchor" href="#path" aria-hidden="true">#</a> Path</h3><p>æŒ‡å®šäº†ä¸»æœºä¸‹çš„å“ªäº›è·¯å¾„å¯ä»¥æ¥å— Cookieï¼ˆè¯¥ URL è·¯å¾„å¿…é¡»å­˜åœ¨äºè¯·æ±‚ URL ä¸­ï¼‰ã€‚</p><p>åœ¨ Domain æ»¡è¶³çš„æƒ…å†µä¸‹ï¼Œ<code>Path</code>å±æ€§æ˜¯ HTTP è¯·æ±‚è·¯å¾„çš„å¼€å¤´ä¸€éƒ¨åˆ†ï¼Œå°±ä¼šåœ¨å¤´ä¿¡æ¯é‡Œé¢å¸¦ä¸Šè¿™ä¸ª Cookieã€‚</p><p>ä»¥å­—ç¬¦Â <code>%x2F</code>(&quot;/&quot;) ä½œä¸ºè·¯å¾„åˆ†éš”ç¬¦ï¼Œå­è·¯å¾„ä¹Ÿä¼šè¢«åŒ¹é…ã€‚</p><aside> â“ **è¿™é‡Œæƒ³åˆ°ä¸€ä¸ªé—®é¢˜æ˜¯ï¼šå¦‚æœ Domain å’Œ Path éšæ„å†™ä¼šæ€ä¹ˆæ ·ï¼Ÿ** å®æµ‹å‘ç°ï¼Œå¦‚æœå‘å…¶ä»–åŸŸåå†™ cookieï¼Œæµè§ˆå™¨ä¼šæ‹¦æˆªï¼š <p><img src="assets/Untitled1.2cac1f37.png" alt="Untitled"></p><p>è€Œå¯¹ Path åˆ™æ— é™åˆ¶ï¼š</p><p><img src="assets/Untitled2.ae116443.png" alt="Untitled"></p></aside><h2 id="samesite" tabindex="-1"><a class="header-anchor" href="#samesite" aria-hidden="true">#</a> SameSite</h2><p>å†³å®šäº†è¯·æ±‚è·¨ç«™ç‚¹æ—¶èƒ½å¦æºå¸¦ Cookie</p><p>å®ƒå¯ä»¥ç”¨æ¥é˜»æ­¢ CSRF æ”»å‡»</p><p>æœ‰ä¸‰ä¸ªå€¼ï¼š</p><ol><li><code>None</code> æµè§ˆå™¨ä¼šåœ¨åŒç«™è¯·æ±‚ã€è·¨ç«™è¯·æ±‚ä¸‹ç»§ç»­å‘é€ cookiesã€‚</li><li><code>Strict</code> æµè§ˆå™¨å°†åªåœ¨è®¿é—®ç›¸åŒç«™ç‚¹æ—¶å‘é€ cookieã€‚ ã€Œç›¸åŒç«™ç‚¹ã€å‚è€ƒ <a href="https://developer.mozilla.org/en-US/docs/Glossary/Site" target="_blank" rel="noopener noreferrer">Site<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> çš„å®šä¹‰ã€‚</li></ol><aside> ğŸ’¡ SameSite å’Œ Same-Origin çš„åŒºåˆ«ï¼Ÿ Same-Origin çš„å®šä¹‰å¾ˆæ˜ç¡®ï¼šåè®®ã€åŸŸåã€ç«¯å£éƒ½ä¸€è‡´çš„å°±æ˜¯ Same-Origin; SameSite åˆ™å®½æ³›ä¸€äº›ï¼Œå®ƒä¸è¦æ±‚åè®®ï¼Œä¹Ÿä¸è¦æ±‚ç«¯å£ï¼Œåªéœ€è¦æ ¹åŸŸåä¸€è‡´å°±è®¤ä¸ºæ˜¯ SameSiteã€‚ å½“ç„¶è¿™é‡Œçš„æ ¹åŸŸåéœ€è¦æ˜¯ã€Œå¯æ³¨å†Œçš„ã€ï¼Œå‚çœ‹åŸæ–‡ï¼š `a site is determined by theÂ ***registrable domain*** Â portion of the domain name.` ä»€ä¹ˆå«å¯æ³¨å†Œçš„ï¼Ÿ `.com` `.edu.com` å°±ä¸å«ï¼Œè€Œ `[github.com](http://github.com)` `[bilibili.com](http://bilibili.com)` å°±ç®—ã€‚ </aside><ol><li><p><code>Lax</code> ä¸Â <strong><code>Strict</code></strong>Â  ç±»ä¼¼ï¼Œå¤§å¤šæ•°æƒ…å†µä¹Ÿæ˜¯ä¸å‘é€ç¬¬ä¸‰æ–¹ Cookieï¼Œä½†æ˜¯å¯¼èˆªåˆ°ç›®æ ‡ç½‘å€çš„ Get è¯·æ±‚é™¤å¤–ã€‚Â åœ¨æ–°ç‰ˆæœ¬æµè§ˆå™¨ä¸­ï¼Œä¸ºé»˜è®¤é€‰é¡¹ã€‚</p><table><thead><tr><th>è¯·æ±‚ç±»å‹</th><th>ç¤ºä¾‹</th><th>None</th><th>Lax</th></tr></thead><tbody><tr><td>é“¾æ¥</td><td><code>&lt;a href=&quot;...&quot;&gt;&lt;/a&gt;</code></td><td>å‘é€ Cookie</td><td>å‘é€ Cookie</td></tr><tr><td>é¢„åŠ è½½</td><td><code>&lt;link rel=&quot;prerender&quot; href=&quot;...&quot;/&gt;</code></td><td>å‘é€ Cookie</td><td>å‘é€ Cookie</td></tr><tr><td>GET è¡¨å•</td><td><code>&lt;form method=&quot;GET&quot; action=&quot;...&quot;&gt;</code></td><td>å‘é€ Cookie</td><td>å‘é€ Cookie</td></tr><tr><td>POST è¡¨å•</td><td><code>&lt;form method=&quot;POST&quot; action=&quot;...&quot;&gt;</code></td><td>å‘é€ Cookie</td><td>ä¸å‘é€</td></tr><tr><td>iframe</td><td><code>&lt;iframe src=&quot;...&quot;&gt;&lt;/iframe&gt;</code></td><td>å‘é€ Cookie</td><td>ä¸å‘é€</td></tr><tr><td>AJAX</td><td><code>$.get(&quot;...&quot;)</code></td><td>å‘é€ Cookie</td><td>ä¸å‘é€</td></tr><tr><td>Image</td><td><code>&lt;img src=&quot;...&quot;&gt;</code></td><td>å‘é€ Cookie</td><td>ä¸å‘é€</td></tr></tbody></table></li></ol><aside> â“ ä¸ºä»€ä¹ˆé»˜è®¤æ˜¯ `Lax` è€Œé `Strict` ? Strict æœ€ä¸ºä¸¥æ ¼ï¼Œå®Œå…¨ç¦æ­¢ç¬¬ä¸‰æ–¹ Cookieï¼Œä½†æ˜¯ä¼šé€ æˆæ¯”è¾ƒå·®çš„ç”¨æˆ·ä½“éªŒï¼š æ¯”å¦‚ï¼Œå½“å‰ç½‘é¡µæœ‰ä¸€ä¸ª GitHub é“¾æ¥ï¼Œç”¨æˆ·ç‚¹å‡»è·³è½¬å°±ä¸ä¼šå¸¦æœ‰ GitHub çš„ Cookieï¼Œè·³è½¬è¿‡å»æ€»æ˜¯æœªç™»é™†çŠ¶æ€ã€‚ï¼ˆ**referer** æ˜¯åŸç«™ç‚¹ï¼Œå¯¼è‡´ Github cookie æ²¡å¸¦ä¸Šï¼‰ <p><a href="https://www.ruanyifeng.com/blog/2019/09/cookie-samesite.html" target="_blank" rel="noopener noreferrer"><span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a></p></aside><h2 id="é™åˆ¶è®¿é—®-secure-httponly" tabindex="-1"><a class="header-anchor" href="#é™åˆ¶è®¿é—®-secure-httponly" aria-hidden="true">#</a> é™åˆ¶è®¿é—® Secure/HttpOnly</h2><h3 id="secure" tabindex="-1"><a class="header-anchor" href="#secure" aria-hidden="true">#</a> Secure</h3><p>æ ‡è®°ä¸ºÂ <code>Secure</code> çš„ Cookie åªåº”é€šè¿‡è¢« HTTPS åè®®åŠ å¯†è¿‡çš„è¯·æ±‚å‘é€ç»™æœåŠ¡ç«¯ï¼Œå› æ­¤å¯ä»¥é¢„é˜²Â <a href="https://developer.mozilla.org/zh-CN/docs/Glossary/MitM" target="_blank" rel="noopener noreferrer">man-in-the-middle<span><svg class="external-link-icon" xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewbox="0 0 100 100" width="15" height="15"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path><polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg><span class="external-link-icon-sr-only">open in new window</span></span></a> æ”»å‡»è€…çš„æ”»å‡»ã€‚</p><p>å¦‚æœé€šä¿¡æ˜¯ HTTPS åè®®ï¼Œè¯¥å¼€å…³è‡ªåŠ¨æ‰“å¼€ã€‚</p><h3 id="httponly" tabindex="-1"><a class="header-anchor" href="#httponly" aria-hidden="true">#</a> HttpOnly</h3><p>æ ‡è®°ä¸ºÂ <code>Secure</code> çš„ Cookie ä¼šä½¿å¾—JavaScriptÂ <code>[Document.cookie](https://developer.mozilla.org/zh-CN/docs/Web/API/Document/cookie)</code>Â API æ— æ³•è®¿é—®å¸¦æœ‰Â <code>HttpOnly</code>Â å±æ€§çš„cookieï¼›æ­¤ç±» Cookie ä»…ä½œç”¨äºæœåŠ¡å™¨ã€‚</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>Set-Cookie: id=a3fWa; Expires=Wed, 21 Oct 2015 07:28:00 GMT; Secure; HttpOnly
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><h1 id="cookie-çš„ä¿®æ”¹" tabindex="-1"><a class="header-anchor" href="#cookie-çš„ä¿®æ”¹" aria-hidden="true">#</a> Cookie çš„ä¿®æ”¹</h1><p>å¦‚æœæœåŠ¡å™¨æƒ³æ”¹å˜ä¸€ä¸ªæ—©å…ˆè®¾ç½®çš„ Cookieï¼Œå¿…é¡»åŒæ—¶æ»¡è¶³å››ä¸ªæ¡ä»¶ï¼šCookie çš„<code>key</code>ã€<code>domain</code>ã€<code>path</code>å’Œ<code>secure</code>éƒ½åŒ¹é…ã€‚ä¸¾ä¾‹æ¥è¯´ï¼Œå¦‚æœåŸå§‹çš„ Cookie æ˜¯ç”¨å¦‚ä¸‹çš„<code>Set-Cookie</code>è®¾ç½®çš„ã€‚</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>**Set-Cookie: key1=value1; domain=example.com; path=/blog**
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>æ”¹å˜ä¸Šé¢è¿™ä¸ª Cookie çš„å€¼ï¼Œå°±å¿…é¡»ä½¿ç”¨åŒæ ·çš„<code>Set-Cookie</code>ã€‚</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>**Set-Cookie: key1=value2; domain=example.com; path=/blog**
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>åªè¦æœ‰ä¸€ä¸ªå±æ€§ä¸åŒï¼Œå°±ä¼šç”Ÿæˆä¸€ä¸ªå…¨æ–°çš„ Cookieï¼Œè€Œä¸æ˜¯æ›¿æ¢æ‰åŸæ¥é‚£ä¸ª Cookieã€‚</p><div class="language-text ext-text line-numbers-mode"><pre class="language-text"><code>**Set-Cookie: key1=value2; domain=example.com; path=/**
</code></pre><div class="line-numbers" aria-hidden="true"><div class="line-number"></div></div></div><p>ä¸Šé¢çš„å‘½ä»¤è®¾ç½®äº†ä¸€ä¸ªå…¨æ–°çš„åŒå Cookieï¼Œä½†æ˜¯<code>path</code>å±æ€§ä¸ä¸€æ ·ã€‚ä¸‹ä¸€æ¬¡è®¿é—®<code>[example.com/blog](http://example.com/blog)</code>çš„æ—¶å€™ï¼Œæµè§ˆå™¨å°†å‘æœåŠ¡å™¨å‘é€ä¸¤ä¸ªåŒåçš„ Cookieã€‚</p></div><!--[--><!--]--></div><footer class="page-meta"><!----><!----><!----></footer><!----><!--[--><!--]--></main><!--]--></div><!----><!--]--></div>
    <script type="module" src="assets/app.47e28445.js" defer></script>
  </body>
</html>
